<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>Math Simulator</title>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel="stylesheet">

    <!----------------------------------------------------------------------------------------------------->
    <!-------------------------------------------PLUGIN STUFF---------------------------------------------->
    <!----------------------------------------------------------------------------------------------------->

    <script src="./Plugins/codemirror/lib/codemirror.js"></script>
    <link rel="stylesheet" href="./Plugins/codemirror/lib/codemirror.css" />
    <script src="./Plugins/codemirror/mode/javascript/javascript.js"></script>
    <link rel="stylesheet" href="./Plugins/codemirror/theme/dracula.css" />
    <link rel="stylesheet" href="./Plugins/codemirror/addon/hint/show-hint.css">
    <script src="./Plugins/codemirror/addon/hint/show-hint.js"></script>
    <script src="./Plugins/codemirror/addon/hint/javascript-hint.js"></script>
    <script src="./Plugins/codemirror/mode/markdown/markdown.js"></script>
    <script src="./Plugins/codemirror/addon/edit/closebrackets.js"></script>

    <!-- INJECT MAKECODE -->
    <!-- <script src="./Plugins/pxt-blockly/blockly_compressed.js"></script>
    <script src="./Plugins/pxt-blockly/blocks_compressed.js"></script>
    <script src="./Plugins/pxt-blockly/msg/js/en.js"></script>
    <script src="./Plugins/pxt-blockly/javascript_compressed.js"></script> -->

    <!-- INSERT BLOCKLY
    <script src=""></script> -->

    <!----------------------------------------------------------------------------------------------------->
    <!--------------------------------------------LIBRARY STUFF-------------------------------------------->
    <!----------------------------------------------------------------------------------------------------->

    <script src="./libraries/phaser.js"></script><!-- PHASER FRAMEWORK -->
    <script src="https://unpkg.com/mathjs@11.1.0/lib/browser/math.js"></script>
    <script src="./libraries/enable3d.phaserExtension.0.25.2.min.js"></script>
    <!--Phaser 3D extension-->
    <!-- <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script> PHASER -->
    <!-- <script src="./libraries/matter.min.js"></script> MATTER -->

    <!----------------------------------------------------------------------------------------------------->
    <!--------------------------------------------CLASSES STUFF-------------------------------------------->
    <!----------------------------------------------------------------------------------------------------->

    <!-- ADD ALL THE GAME LEVELS HERE -->
    <script src="./levels/new_level1.js"></script>

    <!----------------------------------------------------------------------------------------------------->
    <!----------------------------------------------------------------------------------------------------->
</head>

<body>
    <div>
        <h1 style="top:20px; padding-top:10px;padding-left:55px;color:white;">Solve the puzzle</h1>
        <canvas id="canvas" width="750" height="600"></canvas>
        <div class="buttons">
            <div id="blockly">
                <button style="margin-right:10px;" class="int_buttons" id="reset_button">Reset</button>
                <a href="./navigator.html"><button style="margin-left:1.5rem;" class=" int_buttons">Exit</button></a>
                <script src="./blockly_editor.js"></script>
            </div>
        </div>
    </div>
    <img class="res_logo" src="assets/resolute-logo.png" />
    <div style="display:none;" id="error_popup_id" class="error_popup">
        <span onclick="error_window('close');" class="close_x">x</span>
        <p id="err_msg" class="error_text"></p>
    </div>
    <!-- <script>
        var workspace = Blockly.inject('blockly', {
            toolbox: toolbox
        });
    </script> -->
    <script>
        var questions_array = [];
        const DEG_RAD = Math.PI / 180;
        const RAD_DEG = 180 / Math.PI;


        class Questions {
            constructor(numerator, denominator, asked) {
                this.numerator = numerator;
                this.denominator = denominator;
                this.asked = asked;
            }


            getRandomQuestion() {
                let send = questions_array[Math.floor(Math.random() * (questions_array.length - 1 - 0 + 1) + 0)];
                while (send.asked == true) {
                    send = questions_array[Math.floor(Math.random() * (questions_array.length - 1 - 0 + 1) + 0)];
                }
                return [send.question, send.answer];
            }
        }

        // populate array with 200 questions that can be recycled and rearranged
        function initializeArray() {
            for (let i = 0; i < 200; i++) {
                let temp0 = rand_interval(1, 8);
                let temp1 = rand_interval(temp0, 10);
                questions_array.push(new Questions(temp0, temp1, false));
            }
        }


        function rand_interval(begin, end) {
            return Math.floor(Math.random() * (end - begin + 1) + begin);
        }

        initializeArray();
        //set configuration for the scene
        var config = {
            type: Phaser.AUTO,
            width: 750,
            height: 600,
            audio: {
                disableWebAudio: true
            },
            physics: {
                default: 'matter',
                arcade: {
                    debug: true,
                    gravity: {
                        y: 300
                    }
                },
                matter: {
                    debug: false,
                    gravity: {
                        y: 0.8
                    }
                }
            },
            scene: [Level_1]
        };
        //start new game scene
        const gameScene = new Phaser.Game(config);
    </script>
    <script src="./levels/new_level1.js"></script>
</body>

</html>